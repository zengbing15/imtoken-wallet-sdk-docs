"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[245],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>d});var r=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},v=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),v=p(n),d=a,g=v["".concat(s,".").concat(d)]||v[d]||c[d]||i;return n?r.createElement(g,l(l({ref:t},u),{},{components:n})):r.createElement(g,l({ref:t},u))}));function d(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,l=new Array(i);l[0]=v;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var p=2;p<i;p++)l[p]=n[p];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}v.displayName="MDXCreateElement"},4394:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>i,metadata:()=>o,toc:()=>p});var r=n(7462),a=(n(7294),n(3905));const i={sidebar_position:2},l="API",o={unversionedId:"function/API",id:"function/API",title:"API",description:"detect imToken DApp browser",source:"@site/docs/function/API.md",sourceDirName:"function",slug:"/function/API",permalink:"/webview-docs/function/API",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"defaultSidebar",previous:{title:"Provider",permalink:"/webview-docs/function/Provider"},next:{title:"Support WalletConnect",permalink:"/webview-docs/function/WalletConnect Integration"}},s={},p=[{value:"detect imToken DApp browser",id:"detect-imtoken-dapp-browser",level:2},{value:"callAPI (demo for showcase)",id:"callapi-demo-for-showcase",level:2},{value:"API info",id:"api-info",level:2},{value:"general",id:"general",level:3},{value:"isTokenEnv",id:"istokenenv",level:4},{value:"getVersion",id:"getversion",level:4},{value:"isGreaterThanOrEqualVersion",id:"isgreaterthanorequalversion",level:4},{value:"compareSemver",id:"comparesemver",level:4},{value:"navigator",id:"navigator",level:3},{value:"setTitle",id:"settitle",level:4},{value:"getOrientation",id:"getorientation",level:4},{value:"closeDapp",id:"closedapp",level:4},{value:"goBack",id:"goback",level:4},{value:"routeTo",id:"routeto",level:4},{value:"toggleNavbar",id:"togglenavbar",level:4},{value:"device",id:"device",level:3},{value:"getCurrentCurrency",id:"getcurrentcurrency",level:4},{value:"getCurrentLanguage",id:"getcurrentlanguage",level:4},{value:"layout",id:"layout",level:3},{value:"native",id:"native",level:3},{value:"alert",id:"alert",level:4},{value:"confirm",id:"confirm",level:4},{value:"setLoading",id:"setloading",level:4},{value:"share",id:"share",level:4},{value:"scanQRCode",id:"scanqrcode",level:4},{value:"setClipboard",id:"setclipboard",level:4},{value:"user",id:"user",level:3},{value:"internal",id:"internal",level:3},{value:"Debug Tool",id:"debug-tool",level:2}],u={toc:p};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"api"},"API"),(0,a.kt)("h2",{id:"detect-imtoken-dapp-browser"},"detect imToken DApp browser"),(0,a.kt)("p",null,"Detect imToken DApp browser by ",(0,a.kt)("inlineCode",{parentName:"p"},"!!window.imToken")," or ",(0,a.kt)("inlineCode",{parentName:"p"},"window.ethereum.isImToken"),", it will return true if the current browser is imToken DApp browser."),(0,a.kt)("h2",{id:"callapi-demo-for-showcase"},"callAPI (",(0,a.kt)("a",{parentName:"h2",href:"https://simple-demo.vercel.app/"},"demo")," for showcase)"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"imToken.callAPI(apiName, options, callback)")),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Params"),(0,a.kt)("th",{parentName:"tr",align:null},"Type"),(0,a.kt)("th",{parentName:"tr",align:null},"Description"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"apiName"),(0,a.kt)("td",{parentName:"tr",align:null},"string"),(0,a.kt)("td",{parentName:"tr",align:null},"name of the method")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"options"),(0,a.kt)("td",{parentName:"tr",align:null},"object"),(0,a.kt)("td",{parentName:"tr",align:null},"options depend on the specific method")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"callback"),(0,a.kt)("td",{parentName:"tr",align:null},"function"),(0,a.kt)("td",{parentName:"tr",align:null},"callback of method")))),(0,a.kt)("p",null,"Example usage:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"imToken.callAPI(apiName, params, (error, result) => {\n  if (error) {\n    alert(error.message);\n  } else {\n    alert(result);\n  }\n});\n")),(0,a.kt)("p",null,"If you want to call API with Promise style, you can use ",(0,a.kt)("inlineCode",{parentName:"p"},"callPromisifyAPI"),"."),(0,a.kt)("p",null,"Example usage:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"imToken\n  .callPromisifyAPI(apiName, params)\n  .then((result) => alert(result))\n  .catch((error) => {\n    alert(error.message);\n  });\n")),(0,a.kt)("h2",{id:"api-info"},"API info"),(0,a.kt)("h3",{id:"general"},"general"),(0,a.kt)("p",null,"Check the environment and processing of generic scenarios."),(0,a.kt)("h4",{id:"istokenenv"},"isTokenEnv"),(0,a.kt)("p",null,"Check if the current context is imToken WebView and return a boolean value."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"type isTokenEnv = () => boolean\n")),(0,a.kt)("h4",{id:"getversion"},"getVersion"),(0,a.kt)("p",null,"Get the current version of the imToken App."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"type getVersion = () => string\n")),(0,a.kt)("h4",{id:"isgreaterthanorequalversion"},"isGreaterThanOrEqualVersion"),(0,a.kt)("p",null,"The current App version is greater than or equal to the specified value."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"type isGreaterThanOrEqualVersion = (version: string) => boolean\n")),(0,a.kt)("h4",{id:"comparesemver"},"compareSemver"),(0,a.kt)("p",null,"Compare the two versions of the value and return the number."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"type compareSemver = (versionA: string, versionB: string) => number\n")),(0,a.kt)("h3",{id:"navigator"},"navigator"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"TokenWebView.apis.navigator"),": Route navigation and settings page."),(0,a.kt)("h4",{id:"settitle"},"setTitle"),(0,a.kt)("p",null,"Dynamically set dapp title. Have no effect on ",(0,a.kt)("inlineCode",{parentName:"p"},"document.title"),"."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/navigator.ts"',title:'"/webview/apis/navigator.ts"'},"setTitle: (title: string) => {\n    callAPI('navigator.setTitle', title)\n  },\n")),(0,a.kt)("h4",{id:"getorientation"},"getOrientation"),(0,a.kt)("p",null,"Set screen Orientation."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/navigator.ts"',title:'"/webview/apis/navigator.ts"'}," setOrientation: (orientation: Orientation): void => {\n    callAPI('navigator.setOrientation', `${orientation}`.toLowerCase())\n  },\n")),(0,a.kt)("h4",{id:"closedapp"},"closeDapp"),(0,a.kt)("p",null,"Close the current web app."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/navigator.ts"',title:'"/webview/apis/navigator.ts"'}," closeDapp: (): void => {\n    callAPI('navigator.closeDapp')\n  },\n")),(0,a.kt)("h4",{id:"goback"},"goBack"),(0,a.kt)("p",null,"Return to the previous level of routing, or closes the app if there is no routing stack."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/navigator.ts"',title:'"/webview/apis/navigator.ts"'},"goBack: (): void => {\n    callAPI('navigator.goBack')\n  },\n")),(0,a.kt)("h4",{id:"routeto"},"routeTo"),(0,a.kt)("p",null,"Navigate to a special screen."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/navigator.ts"',title:'"/webview/apis/navigator.ts"'},"routeTo: ({ screen, props }: { screen: string; props: ScreenProps }): void => {\n    callAPI('navigator.routeTo', {\n      screen: screen,\n      passProps: props,\n    })\n  },\n")),(0,a.kt)("h4",{id:"togglenavbar"},"toggleNavbar"),(0,a.kt)("p",null,"Hide Navbar manually."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/navigator.ts"',title:'"/webview/apis/navigator.ts"'},"toggleNavbar: (): void => {\n    callAPI('navigator.toggleNavbar')\n  },\n")),(0,a.kt)("h3",{id:"device"},"device"),(0,a.kt)("p",null,"Get the user's current language setting and currency setting."),(0,a.kt)("h4",{id:"getcurrentcurrency"},"getCurrentCurrency"),(0,a.kt)("p",null,'Get currency from user settings, e.g. "CNY".'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/device.ts"',title:'"/webview/apis/device.ts"'},"  getCurrentCurrency: (): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      callAPI('device.getCurrentCurrency', (err: Error, currency: string) => {\n        if (err) return reject(err)\n        resolve(currency)\n      })\n    })\n  },\n")),(0,a.kt)("h4",{id:"getcurrentlanguage"},"getCurrentLanguage"),(0,a.kt)("p",null,'Get the current language, e.g. "en-us".'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/device.ts"',title:'"/webview/apis/device.ts"'},"getCurrentLanguage: (): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      callAPI('device.getCurrentLanguage', (err: Error, language: string) => {\n        if (err) return reject(err)\n        resolve(language)\n      })\n    })\n  },\n")),(0,a.kt)("h3",{id:"layout"},"layout"),(0,a.kt)("p",null,"Set the frame layout style."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/layout.ts"',title:'"/webview/apis/layout.ts"'},"type HexColor = `#${string}`\ntype StatusBarStyle = 0 | 1 | 2\n\ntype WebViewLayoutOptions = {\n  background?: HexColor | Array<HexColor>\n  foreground?: HexColor\n  isTitleLeft?: boolean\n  titleSize?: number\n  isTransparent?: boolean\n  transparentScrollY?: number\n  loadingBackground?: HexColor\n  loadingForeground?: HexColor\n  bodyBackground?: HexColor\n  bodyForeground?: HexColor\n  statusBarStyle?: StatusBarStyle\n}\n\ntype setOptions = (options: WebViewLayoutOptions) => void\n")),(0,a.kt)("p",null,"Example usage:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"TokenWebView.apis.layout.setOptions({\n  background: '#000000',\n  titleSize: 20,\n})\n")),(0,a.kt)("h3",{id:"native"},"native"),(0,a.kt)("h4",{id:"alert"},"alert"),(0,a.kt)("p",null,"Call the native component, UI effects depend on the platform."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/native.ts"',title:'"/webview/apis/native.ts"'},"  alert: (content: string): void => {\n    callAPI('native.alert', content)\n  },\n")),(0,a.kt)("h4",{id:"confirm"},"confirm"),(0,a.kt)("p",null,"Displays a native confirm dialog."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/native.ts"',title:'"/webview/apis/native.ts"'},"confirm: (params: ConfirmParams): Promise<boolean> => {\n    return new Promise(resolve => {\n      callAPI('native.confirm', params, (err: Error) => {\n        if (err) return resolve(false)\n        resolve(true)\n      })\n    })\n  },\n")),(0,a.kt)("h4",{id:"setloading"},"setLoading"),(0,a.kt)("p",null,"Set loading status. the loading layer blocks all events from user."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/native.ts"',title:'"/webview/apis/native.ts"'},"setLoading: (visible: boolean): void => {\n    const method = visible ? 'showLoading' : 'hideLoading'\n    callAPI(`native.${method}`)\n  },\n")),(0,a.kt)("h4",{id:"share"},"share"),(0,a.kt)("p",null,"Share image or url address."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/native.ts"',title:'"/webview/apis/native.ts"'},"share: (params: ShareParams): Promise<OpenReturn> => {\n    const input = !params.image\n      ? params\n      : {\n          title: params.title,\n          url: params.image,\n          type: 'image/png',\n        }\n    return new Promise((resolve, reject) => {\n      callAPI('native.share', input, (err: Error, ret: OpenReturn) => {\n        if (err) return reject(err)\n        resolve(ret)\n      })\n    })\n  },\n")),(0,a.kt)("h4",{id:"scanqrcode"},"scanQRCode"),(0,a.kt)("p",null,"Scan a QRCode and returns string content of the QRCode."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/native.ts"',title:'"/webview/apis/native.ts"'},"scanQRCode: (): Promise<string> => {\n    return new Promise((resolve, reject) => {\n      callAPI('native.scanQRCode', (err: Error, text: string) => {\n        if (err) return reject(err)\n        resolve(text)\n      })\n    })\n  },\n")),(0,a.kt)("h4",{id:"setclipboard"},"setClipboard"),(0,a.kt)("p",null,"Set the user's clipboard."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/native.ts"',title:'"/webview/apis/native.ts"'},"setClipboard: (text: string): void => {\n    callAPI('native.setClipboard', text)\n  },\n")),(0,a.kt)("h3",{id:"user"},"user"),(0,a.kt)("p",null,"Switch the user wallet and return wallet address."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-javascript",metastring:'title="/webview/apis/user.ts"',title:'"/webview/apis/user.ts"'},'type ChainType =\n  | "ETHEREUM"\n  | "BITCOIN"\n  | "LITECOIN"\n  | "EOS"\n  | "COSMOS"\n  | "TRON"\n  | "BITCOINCASH"\n  | "NERVOS"\n  | "KUSAMA"\n  | "POLKADOT"\n  | "FILECOIN";\n\ntype showAccountSwitch = (chainType: ChainType | null) => Promise<string>;\n')),(0,a.kt)("p",null,"Example usage:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"const address = await TokenWebView.apis.user.showAccountSwitch('ETHEREUM')\nconsole.log(address)\n\n// output -> '0x...'\n")),(0,a.kt)("h3",{id:"internal"},"internal"),(0,a.kt)("p",null,"The Internal API is unstable and only for debugging. Please refer to ",(0,a.kt)("inlineCode",{parentName:"p"},"/webview/apis/internal.ts")," for more details."),(0,a.kt)("h2",{id:"debug-tool"},"Debug Tool"),(0,a.kt)("p",null,"There is a ",(0,a.kt)("a",{parentName:"p",href:"https://simple-demo.vercel.app/"},"demo")," to help you debug.\nYou can open this demo with your mobile device to check the API usage."))}c.isMDXComponent=!0}}]);